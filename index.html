<!doctype html><html lang="es"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Notificaciones en Tiempo Real</title><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/><script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script><script defer="defer" src="/portfolio/static/js/main.8518d7f9.js"></script><link href="/portfolio/static/css/main.067b8230.css" rel="stylesheet"></head><body class="container mt-4"><h1 class="text-center mb-4">Pedidos en Tiempo Real</h1><div class="text-center"><button id="btnNuevoPlato" class="btn btn-primary">ğŸš€ Solicitar Nuevo Plato</button> <button id="btnPedir100Platos" class="btn btn-warning" disabled="disabled">ğŸ’¥ Pedir 100 Platos *</button> <button id="btnPedir400Platos" class="btn btn-danger" disabled="disabled">ğŸ”¥ Pedir 400 Platos *</button></div><p>*: Disponible en localhost ya que el servicio de google es pago</p><div class="container mt-4"><div class="row"><div class="col-md-6"><h3>ğŸ“Œ Estado de Pedidos</h3><table class="table table-bordered"><thead class="table-dark"><tr><th>Pedidos</th><th>En Cocina</th><th>Finalizados</th></tr></thead><tbody><tr id="tablaPedidos"><td id="pedidos">-</td><td id="enCocina">-</td><td id="finalizados">-</td></tr></tbody></table></div><div class="col-md-6"><h3>ğŸ½ï¸ Ãšltimos Platos</h3><div style="max-height:400px;overflow-y:auto"><table class="table table-striped"><thead class="table-dark"><tr><th>Nombre</th><th>Fecha en Cocina</th><th>Finalizado</th></tr></thead><tbody id="tabla-platos"></tbody></table></div></div></div></div><div class="container mt-4"><div class="row"><div class="col-md-6"><h3>Ãšltimas Compras</h3><div style="max-height:400px;overflow-y:auto"><table class="table table-striped"><thead class="table-dark"><tr><th>Nombre</th><th>Cantidad Vendida</th><th>Fecha</th></tr></thead><tbody id="tabla-compras"></tbody></table></div></div><div class="col-md-6"><h3>ğŸ›’ Ingredientes en Uso</h3><table class="table table-bordered"><thead class="table-dark"><tr><th>Ingrediente</th><th>Cantidad</th></tr></thead><tbody id="tablaIngredientes"></tbody></table></div></div></div><ul id="pedidos" class="list-group mt-4"></ul><h3 class="text-center">ğŸ½ï¸ Lista de Platos</h3><ul id="listaPlatos" class="list-group mt-4"></ul><script>const serverURL="https://alegra-679014142115.us-central1.run.app",socket=io(serverURL),tablaCompras=document.getElementById("tabla-compras");function formatoFecha(t){if(!t)return"";return new Date(t).toLocaleString("es-ES",{timeZone:"America/Argentina/Buenos_Aires"})}async function actualizarMonitoreoCompras(){try{const t=await fetch(serverURL+"/monitoreo-compras"),e=await t.json();for(const t of e){const e=document.createElement("tr");e.innerHTML=`\n                    <td>${t.ingrediente}</td>\n                    <td>${t.quantitySold}</td>\n                    <td>${formatoFecha(t.createdAt)}</td>\n                `,tablaCompras.append(e)}}catch(t){console.error("âŒ Error al obtener monitoreo:",t)}}function llenarTablaPlatos(t){const e=t.platos;actualizarVista(t);const n=document.getElementById("tabla-platos");n.innerHTML="",e.forEach((t=>{const e=document.createElement("tr");e.innerHTML=`\n              <td>${t.receta}</td>\n              <td>${formatoFecha(t.recibidoCocina)}</td>\n              <td>${formatoFecha(t.finalizado)}</td>\n            `,n.appendChild(e)}))}async function cargarMonitoreo(){try{const t=await fetch(serverURL+"/monitoreo-platos");llenarTablaPlatos(await t.json())}catch(t){console.error("Error al obtener los datos:",t)}}async function actualizarMonitoreoIngredientes(){try{const t=await fetch(serverURL+"/monitoreo-ingredientes");actualizarVistaIngredientes(await t.json())}catch(t){console.error("âŒ Error al obtener monitoreo:",t)}}function actualizarVista(t){document.getElementById("pedidos").textContent=t.pedidos,document.getElementById("enCocina").textContent=t.enCocina,document.getElementById("finalizados").textContent=t.finalizados}function actualizarVistaIngredientes(t){const e=document.getElementById("tablaIngredientes");e.innerHTML="",t.forEach((t=>{const n=`<tr>\n                        <td>${t.nombre}</td>\n                        <td>${t.cantidad}</td>\n                    </tr>`;e.innerHTML+=n}))}async function solicitarPlato(){try{const t=await fetch(serverURL+"/nuevoPlato",{method:"GET"});await t.json()}catch(t){console.error("âŒ Error al solicitar el plato:",t)}}socket.on("mensajePrueba",(t=>{console.log(t)})),socket.on("compras",(t=>{console.log("nueva compra");const e=document.createElement("tr");e.innerHTML=`\n                <td>${t.ingrediente}</td>\n                <td>${t.quantitySold}</td>\n                <td>${formatoFecha(t.createdAt)}</td>\n            `,tablaCompras.prepend(e)})),socket.on("platos",(t=>{console.log("nueva platos"),llenarTablaPlatos(t)})),socket.on("ingredientes",(t=>{console.log("nueva ingredientes"),actualizarVistaIngredientes(t)})),cargarMonitoreo(),actualizarMonitoreoIngredientes(),actualizarMonitoreoCompras(),document.getElementById("btnNuevoPlato").addEventListener("click",(async()=>{const t=document.getElementById("btnNuevoPlato");t.disabled=!0,t.textContent="â³ Solicitando...",await solicitarPlato(),t.disabled=!1,t.textContent="ğŸš€ Solicitar Nuevo Plato"})),document.getElementById("btnPedir100Platos").addEventListener("click",(async()=>{const t=document.getElementById("btnPedir100Platos");t.disabled=!0,t.textContent="ğŸ’¥ Enviando 100 pedidos...";for(let t=0;t<100;t++)await solicitarPlato();t.disabled=!1,t.textContent="ğŸ’¥ Pedir 100 Platos"})),document.getElementById("btnPedir400Platos").addEventListener("click",(async()=>{const t=document.getElementById("btnPedir400Platos");t.disabled=!0,t.textContent="ğŸ”¥ Enviando 400 pedidos...";for(let t=0;t<400;t++)await solicitarPlato();t.disabled=!1,t.textContent="ğŸ”¥ Pedir 400 Platos"}));const RECIPES={polloConEnsalada:{name:"Pollo con ensalada",ingredients:[{name:"chicken",count:1},{name:"lemon",count:1},{name:"lettuce",count:1},{name:"tomato",count:2}]},carneConPapasFritas:{name:"Carne con purÃ©",ingredients:[{name:"meat",count:1},{name:"potato",count:2}]},ensalada:{name:"Ensalada",ingredients:[{name:"onion",count:1},{name:"cheese",count:2},{name:"lettuce",count:1},{name:"tomato",count:2}]},arrozConPollo:{name:"Arroz con pollo",ingredients:[{name:"rice",count:1},{name:"chicken",count:2},{name:"ketchup",count:1}]},arrozConQueso:{name:"Arroz con queso",ingredients:[{name:"rice",count:1},{name:"cheese",count:2},{name:"lemon",count:2}]},tortillaDePapas:{name:"Tortilla de papas",ingredients:[{name:"potato",count:3},{name:"ketchup",count:1},{name:"onion",count:2}]}},listaPlatos=document.getElementById("listaPlatos");for(const t in RECIPES){const e=RECIPES[t],n=document.createElement("li");n.classList.add("list-group-item"),n.innerHTML=`<strong>${e.name}</strong><br>\n                              ğŸ¥• Ingredientes: ${e.ingredients.map((t=>`${t.name} (${t.count})`)).join(", ")}`,listaPlatos.appendChild(n)}</script></body></html>